... A B C A B C   ...
...  + + + + +    ...

into

... A B C B C A  ...
...  + + - + + + ...
